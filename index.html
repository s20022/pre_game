<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

<script>
  let game;

  let gameOptions = {
    platformSpeedRange: [300,300],

    spawnRange: [80, 300],

    platformHeightRnage: [-5, 5],

    platformHeighScale: 20,

    platformVerticalLimit: [0.4, 0.8],

    playerGravity: 900,

    jumpForce: 400,

    playerStartPosition: 200,

    jumps: 2,

    coinPercent: 25
  }

  window.onload = function() {
  let gameConfig = {
    type: Phaser.AUTO,
    width: 800,
    height: 600,
    scene: [preloadGame, playGame],
    physics: {
      default: "arcade"
    }
  }

  game = new Phaser.Game(gameConfig);
  wondow.focus();
  resize();
  window.addEventListener("resize", resize, false)

  }

  //ゲーム開始前の定義
  class preloadGame extends Phaser.Scene {
    constructor() {
      super("PreloadGame");
    }

    preload() {
      this.load.image('sky', 'assets/sky.png');
      this.load.image('coin', 'assets/coin.png');
      this.load.image('ground', 'assets/ground3.png');
      this.load.spritesheet('you', 'assets/kisi_kirinuki.png', {
        frameWidth: 32, frameHeight: 32
      });
    }

//ゲーム開始時に呼び出されるもの

    create() {
      this.anims.create({
        key: 'right',
        frames: this.anims.generateFrameNumbers('you', {start: 0, end: 2}),
        frameRate: 10,
        repeat: -1
      });
    }
  }

    class playGame extends Phaser.Scene{
      constructor() {
        super("PlayGame");
      }

      create(){
        this.platformGroup = this.add.group({
          removeCallback: function (platform){
            platform.scene.platformPool.add(platform)
          }
        });

        this.platformPool = this.add.group({
          removeCallback: function (platForm) {
            platform.scene.platformGroup.add(platform)
          }
        });
        this.coinGroup = this.add.group({
          removeCallback: function (coin){
            coin.scene.coinPool.add(coin)
          }
        });

        this.coinPool = this.add.group({
          removeCallback: function (coin){
            coin.scene.coinGroup.add(coin)
          }
        });

        this.addedPlatforms = 0;

        this.playerJumps = 0;

        this.addPlatform(game.config.width, game.config.width / 2, game.config.height * 0.7, "player");
        this.player.setGravityY(gameOptions.playerGravity);
        this.player.setDepth(2);


      }
  }
</script>

</body>
</html>